<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Track Team Manager</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    header {
      background: #333;
      color: #fff;
      padding: 1em;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 1em;
    }
    .section {
      background: #fff;
      margin: 10px 0;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    h2 {
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }
    .event {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 0;
    }
    .event span {
      flex: 1;
    }
    button {
      padding: 5px 10px;
      border: none;
      background: #28a745;
      color: #fff;
      border-radius: 3px;
      cursor: pointer;
      margin-left: 10px;
    }
    button:disabled {
      background: #aaa;
      cursor: not-allowed;
    }
    pre {
      background: #eee;
      padding: 10px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <header>
    <h1>Track Team Manager</h1>
    <p>Manage your team, train your athletes, and compete in track events!</p>
  </header>
  <div class="container">
    <!-- Team Funds and Passive Income -->
    <div class="section" id="teamStats">
      <h2>Team Stats</h2>
      <p id="funds">Funds: $100</p>
      <p>Passive Income: +$1 per second</p>
    </div>
    
    <!-- Training Section -->
    <div class="section" id="training">
      <h2>Training</h2>
      <div id="trainingList">
        <!-- Training events will be dynamically inserted here -->
      </div>
    </div>
    
    <!-- Competition Section -->
    <div class="section" id="competition">
      <h2>Competition</h2>
      <div id="competitionList">
        <!-- Competition preview will be dynamically inserted here -->
      </div>
      <button id="competeButton">Run Competition</button>
      <pre id="competitionResult">Competition results will appear here.</pre>
    </div>
  </div>
  
  <script>
    // Convert seconds to mm:ss.xx format
    function formatTime(totalSeconds) {
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      const secondsStr = seconds < 10 ? '0' + seconds.toFixed(2) : seconds.toFixed(2);
      return (minutes < 10 ? '0' + minutes : minutes) + ':' + secondsStr;
    }
    
    // Starting funds and passive income (idle gain)
    let funds = 100;
    const passiveIncome = 1; // funds earned per second

    // Define our track events with more realistic times.
    // Each event now has a minimum possible time.
    const events = [
      { name: '100m',  distance: 100,  trainingLevel: 0, baseTime: 12.0, improvement: 0.3, minTime: 10.0 },
      { name: '200m',  distance: 200,  trainingLevel: 0, baseTime: 25.0, improvement: 0.5, minTime: 20.0 },
      { name: '400m',  distance: 400,  trainingLevel: 0, baseTime: 60.0, improvement: 1.0, minTime: 45.0 },
      { name: '800m',  distance: 800,  trainingLevel: 0, baseTime: 130.0, improvement: 2.0, minTime: 100.0 },
      { name: '1600m', distance: 1600, trainingLevel: 0, baseTime: 280.0, improvement: 4.0, minTime: 200.0 },
      { name: '3200m', distance: 3200, trainingLevel: 0, baseTime: 600.0, improvement: 8.0, minTime: 400.0 }
    ];

    // Training cost increases with level; you can adjust the multiplier as needed.
    function trainingCost(event) {
      return 50 * (event.trainingLevel + 1);
    }

    // Update the training list UI
    function updateTrainingList() {
      const trainingList = document.getElementById('trainingList');
      trainingList.innerHTML = '';
      events.forEach((event, index) => {
        const div = document.createElement('div');
        div.className = 'event';
        div.innerHTML = `
          <span><strong>${event.name}</strong> (Level: ${event.trainingLevel})</span>
          <span>Cost: $${trainingCost(event)}</span>
          <button onclick="trainEvent(${index})">Train</button>
        `;
        trainingList.appendChild(div);
      });
    }

    // Handle training: subtract funds and increase the event's training level.
    function trainEvent(index) {
      const event = events[index];
      const cost = trainingCost(event);
      if (funds >= cost) {
        funds -= cost;
        event.trainingLevel++;
        updateUI();
      } else {
        alert("Not enough funds!");
      }
    }

    // Update the competition preview list UI.
    function updateCompetitionList() {
      const competitionList = document.getElementById('competitionList');
      competitionList.innerHTML = '';
      events.forEach(event => {
        // Calculate a "predicted time" based on training.
        const predictedTime = Math.max(event.baseTime - event.trainingLevel * event.improvement, event.minTime);
        const div = document.createElement('div');
        div.className = 'event';
        div.innerHTML = `<span>${event.name}: Predicted Time: ${formatTime(predictedTime)}</span>`;
        competitionList.appendChild(div);
      });
    }

    // Simulate the competition.
    // For each event, we add a random variation (+/- 10%).
    // If performance is at or better than the predicted time, you win that event.
    // Rewards are based on event distance.
    function runCompetition() {
      let totalReward = 0;
      let resultText = '';
      events.forEach(event => {
        const predictedTime = Math.max(event.baseTime - event.trainingLevel * event.improvement, event.minTime);
        // Simulate actual performance with a random variation of up to ±10%
        const variation = 1 + (Math.random() - 0.5) / 5; // variation between 0.9 and 1.1
        const performance = predictedTime * variation;
        let reward = 0;
        if (performance <= predictedTime) {
          // Winning gives a higher reward.
          reward = Math.round(100 * (event.distance / 100));
          resultText += `${event.name}: WIN! Time: ${formatTime(performance)} — Reward: $${reward}\n`;
        } else {
          // A loss gives a smaller reward.
          reward = Math.round(50 * (event.distance / 100));
          resultText += `${event.name}: Loss. Time: ${formatTime(performance)} — Consolation: $${reward}\n`;
        }
        totalReward += reward;
      });
      funds += totalReward;
      document.getElementById('competitionResult').innerText = resultText;
      updateUI();
    }

    // Update all UI elements
    function updateUI() {
      document.getElementById('funds').innerText = `Funds: $${funds}`;
      updateTrainingList();
      updateCompetitionList();
    }

    // Increase funds passively every second
    setInterval(() => {
      funds += passiveIncome;
      updateUI();
    }, 1000);

    // Attach competition button click handler
    document.getElementById('competeButton').addEventListener('click', runCompetition);

    // Initial UI update
    updateUI();
  </script>
</body>
</html>
